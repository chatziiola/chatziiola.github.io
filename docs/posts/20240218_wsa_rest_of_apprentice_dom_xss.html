<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>WSA Rest of apprentice XSS labs</title>
<meta name="author" content="Lamprinos Chatziioannou" />
<meta name="description" content="Complementary writeup for three WSA labs on XSS" />
<meta name="generator" content="Org Mode" />
<link rel="preconnect" href="https://fonts.googleapis.com"> <link href="https://fonts.googleapis.com/css2?family=Fira+Sans&display=swap" rel="stylesheet"> <link href="https://fonts.googleapis.com/css2?family=Roboto+Condensed&display=swap" rel="stylesheet"> <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono&display=swap" rel="stylesheet"> <script src="https://cdn.jsdelivr.net/gh/oyvindstegard/ox-tagfilter-js/ox-tagfilter.js"></script> <link rel="stylesheet" href="/src/rougier.min.css" /> <script src="/src/copy-pre.min.js"></script> <script src="/src/theme-switcher.min.js" defer></script> <link rel="icon" type="image/x-icon" href="/src/favicon.ico"> <meta charset="UTF-8" name="viewport" content="width=device-width, initial-scale=1.0"> <!-- Google tag (gtag.js) --> <script async src="https://www.googletagmanager.com/gtag/js?id=G-55X4GXWBKS"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-55X4GXWBKS'); </script><script src="https://kit.fontawesome.com/78d5a086dd.js" crossorigin="anonymous"></script>
</head>
<body>
<div id="preamble" class="status">
<div id="org-div-home-and-up"><a accesskey="H" href="/index.html"> HOME </a> | <button id="theme-toggle" title="Toggle theme">ðŸŒ“</button></div>
</div>
<div id="content" class="content">
<h1 class="title">WSA Rest of apprentice XSS labs</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#org15489b4">Introduction</a></li>
<li><a href="#orgf0317d3">Lab 1: Reflected XSS into attribute with angle brackets HTML-encoded</a></li>
<li><a href="#orgabb47e4">Lab 2: Stored XSS into anchor href attribute with double quotes HTML-encoded</a></li>
<li><a href="#org87c6b6e">Lab 3:  Reflected XSS into a JavaScript string with angle brackets HTML encoded</a></li>
<li><a href="#orge301306">Summary</a></li>
</ul>
</div>
</div>
<div id="outline-container-org15489b4" class="outline-2">
<h2 id="org15489b4"><a href="#org15489b4">Introduction</a></h2>
<div class="outline-text-2" id="text-org15489b4">
<p>
Here we are, yet again. Little less than one hour (ideally) before
turning this computer off, starting to work on WSA labs (hoping to
tick some more off today).<sup><a id="fnr.1" class="footref" href="#fn.1" role="doc-backlink">1</a></sup>
</p>
</div>
</div>
<div id="outline-container-orgf0317d3" class="outline-2">
<h2 id="orgf0317d3"><a href="#orgf0317d3">Lab 1: Reflected XSS into attribute with angle brackets HTML-encoded</a></h2>
<div class="outline-text-2" id="text-orgf0317d3">
<p>
You can check the lab out: <a href="https://portswigger.net/web-security/cross-site-scripting/contexts/lab-attribute-angle-brackets-html-encoded">here</a>
</p>

<p>
Quickly we can see that the search field is where we should focus our
attention. Checking the source code after some attempts, it becomes
apparent that we can modify our input so that it adds a parameter and
<code>onmouseover</code> just does the job
</p>


<div id="orgbaa204b" class="figure">
<p><img src="images/Lab_1:_Reflected_XSS_into_attribute_with_angle_brackets_HTML-encoded/20240219_092926_screenshot.png" alt="20240219_092926_screenshot.png">
</p>
<p><span class="figure-number">Figure 1: </span>Solving it</p>
</div>
</div>
</div>
<div id="outline-container-orgabb47e4" class="outline-2">
<h2 id="orgabb47e4"><a href="#orgabb47e4">Lab 2: Stored XSS into anchor href attribute with double quotes HTML-encoded</a></h2>
<div class="outline-text-2" id="text-orgabb47e4">
<p>
You can check the lab out: <a href="https://portswigger.net/web-security/cross-site-scripting/contexts/lab-href-attribute-double-quotes-html-encoded">here</a>
</p>

<p>
This one is fairly easy. Heading to the comment section we can see
that there are some input fields that are available to us. The only
thing that <b>needs attention</b> here is to <b>use all available parameters</b>.
This one took some more time than I would like to admit, because of my
tendency to supply as little info as possible: I had not entered
nothing in the website field, which is critical for this lab.
</p>

<p>
Plain old JavaScript links do the job:
</p>
<pre class="example" id="org50d9ed3">
javascript:alert(1)
</pre>


<div id="org347d8d6" class="figure">
<p><img src="images/Lab_2:_Stored_XSS_into_anchor_href_attribute_with_double_quotes_HTML-encoded/20240219_093544_screenshot.png" alt="20240219_093544_screenshot.png">
</p>
<p><span class="figure-number">Figure 2: </span>Now, old comment section</p>
</div>
</div>
</div>
<div id="outline-container-org87c6b6e" class="outline-2">
<h2 id="org87c6b6e"><a href="#org87c6b6e">Lab 3:  Reflected XSS into a JavaScript string with angle brackets HTML encoded</a></h2>
<div class="outline-text-2" id="text-org87c6b6e">
<p>
You can check the lab out: <a href="https://portswigger.net/web-security/cross-site-scripting/contexts/lab-javascript-string-angle-brackets-html-encoded">here</a>
</p>

<p>
Checking out the website&rsquo;s source code we see that there exists this
snippet, which is of interest since it handles our input:
</p>
<div class="org-src-container">
<pre class="src src-js" id="org477dbc2"><span class="org-keyword">var</span> <span class="org-variable-name">searchTerms</span> = <span class="org-string">'" test'</span>;
document.write(<span class="org-string">'&lt;img src="/resources/images/tracker.gif?searchTerms='</span>+encodeURIComponent(searchTerms)+<span class="org-string">'"&gt;'</span>);
</pre>
</div>

<p>
I&rsquo;m seeking of a payload in the following form:<sup><a id="fnr.2" class="footref" href="#fn.2" role="doc-backlink">2</a></sup>
</p>
<pre class="example" id="orgcd6a3de">
' onerror="alert(1)" '
</pre>

<p>
The thing, is though, that:
</p>
<ol class="org-ol">
<li>This invalidates the <code>var</code> assignment</li>
<li>The usage of <code>encodeURIComponent</code>, really messes up our input.</li>
</ol>


<p>
There I was, thinking of a possible solution to overcome those two
problems when it finally got to me: the first one is no problem.
Instead, I can just add <b>as many commands</b> as I want there, separated by
<code>;</code>. The only thing I need to pay attention to is to comment out the
last part of the line to avoid the remaining <code>'</code> causing any problems.
</p>



<div id="orgef10123" class="figure">
<p><img src="images/Lab_3:/20240219_110149_screenshot.png" alt="20240219_110149_screenshot.png">
</p>
<p><span class="figure-number">Figure 3: </span>Solution</p>
</div>
</div>
</div>
<div id="outline-container-orge301306" class="outline-2">
<h2 id="orge301306"><a href="#orge301306">Summary</a></h2>
<div class="outline-text-2" id="text-orge301306">
<p>
Last week when I wrote my
<a href="20240213_wsa_blind_sql_injection_with_conditional_errors.html#orgbe49e47">first wsa walkthrough</a> I set a goal of completing
210 labs in this semester. I am afraid that it might be a little too
much for someone with a schedule like mine, but I think it is viable.
Sticking to it.
</p>

<blockquote>
<p>
Stating this here, I aim to complete at least 210 labs (roughly 80% of
the ones available in the website) by the end of May.
</p>
</blockquote>
</div>
</div>
<div id="footnotes">
<h2 class="footnotes">Footnotes: </h2>
<div id="text-footnotes">

<div class="footdef"><sup><a id="fn.1" class="footnum" href="#fnr.1" role="doc-backlink">1</a></sup> <div class="footpara" role="doc-footnote"><p class="footpara">
Long story short &#x2026; things did not exactly go that way. 
</p></div></div>

<div class="footdef"><sup><a id="fn.2" class="footnum" href="#fnr.2" role="doc-backlink">2</a></sup> <div class="footpara" role="doc-footnote"><p class="footpara">
Good but newbie, as shown first idea. 
</p></div></div>


</div>
</div></div>
<div id="postamble" class="status">
<script src="https://giscus.app/client.js" data-repo="chatziiola/chatziiola.github.io" data-repo-id=x\"R_kgDOGq8p0g" data-category="Announcements" data-category-id="DIC_kwDOGq8p0s4COSFW" data-mapping="pathname" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="bottom" data-theme="light" data-lang="en" data-loading="lazy" crossorigin="anonymous" async> </script> <p class=\"date footer\"> Originally created on 2024-02-18 Sun 23:05</p><p class="footer"> Made with Emacs and Org.<br>CSS theme based on the one developed by <a href="https://github.com/rougier">@rougier</a>.<br> <a href="https://github.com/chatziiola"> <i class="fa-brands fa-github"></i> </a> <a href="https://www.linkedin.com/in/chatziiola"> <i class="fa-brands fa-linkedin"></i> </a> <a href="/posts/rss.xml"> <i class="fa-solid fa-rss"></i> </a> </p>
</div>
</body>
</html>
